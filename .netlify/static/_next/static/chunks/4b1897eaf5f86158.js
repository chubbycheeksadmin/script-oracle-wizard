(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,550,e=>{"use strict";function t(e){let t=e;return(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/^\s*\d+\s*$/gm,"")).replace(/^Page \d+ of \d+$/gim,"")).replace(/^\s*-\s*\d+\s*-\s*$/gm,"")).replace(/^(CONTINUED|MORE|\(CONTINUED\)|\(MORE\))$/gim,"")).replace(/^\s*CONT'D\s*$/gim,"")).replace(/^(INT|EXT|INT\/EXT|I\/E)[\s:\-]+/gim,(e,t)=>t.toUpperCase()+". ")).replace(/\n{4,}/g,"\n\n\n")).split("\n").map(e=>e.trim()).join("\n")).trim()}async function r(e){try{let t=await fetch("/api/extract-script",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pdfText:e})});if(!t.ok){let e=await t.json();throw Error(e.error||`HTTP ${t.status}`)}return await t.json()}catch(e){return console.error("AI extraction error:",e),{success:!1,extractedScript:null,error:e instanceof Error?e.message:"Failed to extract script"}}}async function a(e){try{let t=new AbortController,r=setTimeout(()=>t.abort(),3e5),a=await fetch("/api/breakdown-script",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pdfText:e,stream:!1}),signal:t.signal});if(clearTimeout(r),!a.ok){let e=await a.json();throw Error(e.error||`HTTP ${a.status}`)}return await a.json()}catch(e){return console.error("AI breakdown error:",e),{scriptExtracted:!1,error:e instanceof Error?e.message:"Failed to breakdown script"}}}async function o(e,t,r,a){try{t({stage:"initializing",message:"Initializing AI analysis..."});let a=new AbortController,o=setTimeout(()=>a.abort(),18e4);t({stage:"analyzing",message:"Analyzing script structure..."});let n=await fetch("/api/breakdown-script",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pdfText:e,stream:!1}),signal:a.signal});if(clearTimeout(o),!n.ok){let e,t=await n.text();console.error("[AI Breakdown] API error:",n.status,t);try{e=JSON.parse(t)}catch{e={error:t}}throw Error(e.error||`HTTP ${n.status}`)}let i=await n.json();console.log("[AI Breakdown] Result:",i.scriptExtracted?"success":"failed",i.error||""),i.scriptExtracted&&i.breakdown&&(t({stage:"scenes",message:`Identified ${i.breakdown.totalScenes} scenes...`}),await s(300),t({stage:"locations",message:`Found ${i.breakdown.uniqueLocations} unique locations...`}),await s(300),i.breakdown.rollup&&(t({stage:"schedule",message:`Estimated ${i.breakdown.rollup.estimatedShootDays} shoot days...`}),await s(300),i.breakdown.rollup.hasTechnicalShots&&(t({stage:"features",message:"Detected technical shots..."}),await s(200)),i.breakdown.rollup.hasHeroProduct&&(t({stage:"features",message:"Found hero product moment..."}),await s(200)),"none"!==i.breakdown.rollup.vfxComplexity&&(t({stage:"features",message:`VFX complexity: ${i.breakdown.rollup.vfxComplexity}...`}),await s(200))),t({stage:"complete",message:"Analysis complete!"})),r(i)}catch(e){console.error("Streaming AI breakdown error:",e),a(e instanceof Error?e.message:"Failed to breakdown script")}}function s(e){return new Promise(t=>setTimeout(t,e))}e.s(["cleanScriptText",()=>t,"extractScriptWithAI",()=>r,"getAIBreakdown",()=>a,"getAIBreakdownStreaming",()=>o])}]);